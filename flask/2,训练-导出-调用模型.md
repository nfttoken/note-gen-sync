## 1,训练模型与导出模型

1. 训练模型 简洁代码示例：
   ```python

   from sklearn import datasets
   from sklearn.tree import DecisionTreeClassifier
   from sklearn.model_selection import train_test_split
   from sklearn.metrics import accuracy_score
   import joblib

   def train_model():
      iris_df = datasets.load_iris()

      x = iris_df.data
      y = iris_df.target

      X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.25)
      dt = DecisionTreeClassifier().fit(X_train, y_train)
      preds = dt.predict(X_test)

      accuracy = accuracy_score(y_test, preds)

   # 使用joblib导出模型，可以是model后缀，也可以是pkl后缀
      joblib.dump(dt, 'iris-model.model')
      print('Model Training Finished.\n\tAccuracy obtained: {}'.format(accuracy))
   ```



## 2,调用模型，输出预测

调用模型--进行预测--输出API路径，简洁代码示例：

```python
import numpy as np
from flask import Flask, request, render_template
from sklearn import preprocessing
# import pickle
import os
import joblib

app = Flask(__name__)

model = joblib.load(open('heroku-ml-deployment-main/rfmodel.model', 'rb'))

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/predict',methods=['POST'])
def predict():
    feature_list = request.form.to_dict()
    feature_list = list(feature_list.values())
    feature_list = list(map(int, feature_list))
    final_features = np.array(feature_list).reshape(1, 12) 
  
    prediction = model.predict(final_features)
    output = int(prediction[0])
    if output == 1:
        text = ">50K"
    else:
        text = "<=50K"

    return render_template('index.html', prediction_text='Employee Income is {}'.format(text))


if __name__ == "__main__":
    app.run(debug=False)
```
